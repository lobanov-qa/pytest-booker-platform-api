import{e as d,a as e,y as u,D as x,z as h,F as m,G as p,I as g,L as j,u as o}from"./entry.client-BQC1QHDZ.js";const f=({total:l,current:s,barLength:n=25,emptyChar:r="░",filledChar:i="█"})=>{const t=Math.round(s/l*100),c=Math.round(t/100*n),a=n-c;return e.jsxs(e.Fragment,{children:[i.repeat(c),r.repeat(a)," ",t,"% (",s,"/",l,")"]})},v=({children:l})=>{const[s,n]=d.useState({status:"idle"}),r=d.useCallback(()=>{n({status:"indexing",total:0,current:0,path:""});const t=new EventSource("/__z/pagefind-reindex");return t.onmessage=c=>{const a=JSON.parse(c.data);a.type==="progress"?n({status:"indexing",total:a.total,current:a.current,path:a.path}):a.type==="complete"&&(t.close(),a.success?n({status:"complete",indexed:a.indexed}):n({status:"error",message:a.error??"Indexing failed"}))},t.onerror=()=>{t.close(),n({status:"error",message:"Connection lost during indexing"})},()=>t.close()},[]);d.useEffect(()=>{if(s.status==="idle")return r()},[s.status,r]);const i=()=>{s.status==="complete"&&window.location.reload()};return e.jsxs(u,{children:[e.jsx(x,{asChild:!0,children:l}),e.jsxs(h,{className:"max-w-sm! top-1/3",showCloseButton:!1,onInteractOutside:t=>t.preventDefault(),children:[e.jsxs(m,{children:[e.jsxs(p,{children:[s.status==="indexing"&&"Building Search Index",s.status==="complete"&&"Indexing Complete",s.status==="error"&&"Indexing Failed",s.status==="idle"&&"Build Search Index"]}),e.jsxs(g,{children:[s.status==="indexing"&&e.jsxs(e.Fragment,{children:[s.total>0&&e.jsx("div",{className:"font-mono text-sm mb-2",children:e.jsx(f,{...s})}),s.path&&e.jsx("span",{className:"block text-xs truncate",children:s.path})]}),s.status==="complete"&&e.jsxs(e.Fragment,{children:["Successfully indexed ",s.indexed," pages."]}),s.status==="error"&&e.jsx("span",{className:"text-destructive",children:s.message})]})]}),e.jsx(j,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[s.status==="complete"&&e.jsx(o,{size:"sm",onClick:i,children:"Close and reload"}),s.status==="error"&&e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"outline",onClick:i,children:"Cancel"}),e.jsx(o,{onClick:r,children:"Retry"})]})]})})]})]})};export{v as default};
//# sourceMappingURL=IndexingDialog-DZWj_3cU-BkrtX9Hh.js.map
