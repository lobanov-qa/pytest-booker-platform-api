{"version":3,"file":"IndexingDialog-DZWj_3cU-DGDvmfWG.js","sources":["../../../../node_modules/zudoku/lib/IndexingDialog-DZWj_3cU.js"],"sourcesContent":["import { j as e } from \"./jsx-runtime-BzflLqGi.js\";\nimport { DialogTrigger as c } from \"@radix-ui/react-dialog\";\nimport { useState as u, useCallback as x, useEffect as m } from \"react\";\nimport { B as d } from \"./Button-IOAeVaIH.js\";\nimport { D as g, a as p, b as h, c as f, d as j, e as D } from \"./Dialog-BQciPiHN.js\";\nconst C = ({\n  total: i,\n  current: s,\n  barLength: a = 25,\n  emptyChar: r = \"░\",\n  filledChar: o = \"█\"\n}) => {\n  const t = Math.round(s / i * 100), l = Math.round(t / 100 * a), n = a - l;\n  return /* @__PURE__ */ e.jsxs(e.Fragment, { children: [\n    o.repeat(l),\n    r.repeat(n),\n    \" \",\n    t,\n    \"% (\",\n    s,\n    \"/\",\n    i,\n    \")\"\n  ] });\n}, F = ({ children: i }) => {\n  const [s, a] = u({\n    status: \"idle\"\n  }), r = x(() => {\n    a({ status: \"indexing\", total: 0, current: 0, path: \"\" });\n    const t = new EventSource(\"/__z/pagefind-reindex\");\n    return t.onmessage = (l) => {\n      const n = JSON.parse(l.data);\n      n.type === \"progress\" ? a({\n        status: \"indexing\",\n        total: n.total,\n        current: n.current,\n        path: n.path\n      }) : n.type === \"complete\" && (t.close(), n.success ? a({ status: \"complete\", indexed: n.indexed }) : a({\n        status: \"error\",\n        message: n.error ?? \"Indexing failed\"\n      }));\n    }, t.onerror = () => {\n      t.close(), a({\n        status: \"error\",\n        message: \"Connection lost during indexing\"\n      });\n    }, () => t.close();\n  }, []);\n  m(() => {\n    if (s.status === \"idle\")\n      return r();\n  }, [s.status, r]);\n  const o = () => {\n    s.status === \"complete\" && window.location.reload();\n  };\n  return /* @__PURE__ */ e.jsxs(g, { children: [\n    /* @__PURE__ */ e.jsx(c, { asChild: !0, children: i }),\n    /* @__PURE__ */ e.jsxs(\n      p,\n      {\n        className: \"max-w-sm! top-1/3\",\n        showCloseButton: !1,\n        onInteractOutside: (t) => t.preventDefault(),\n        children: [\n          /* @__PURE__ */ e.jsxs(h, { children: [\n            /* @__PURE__ */ e.jsxs(f, { children: [\n              s.status === \"indexing\" && \"Building Search Index\",\n              s.status === \"complete\" && \"Indexing Complete\",\n              s.status === \"error\" && \"Indexing Failed\",\n              s.status === \"idle\" && \"Build Search Index\"\n            ] }),\n            /* @__PURE__ */ e.jsxs(j, { children: [\n              s.status === \"indexing\" && /* @__PURE__ */ e.jsxs(e.Fragment, { children: [\n                s.total > 0 && /* @__PURE__ */ e.jsx(\"div\", { className: \"font-mono text-sm mb-2\", children: /* @__PURE__ */ e.jsx(C, { ...s }) }),\n                s.path && /* @__PURE__ */ e.jsx(\"span\", { className: \"block text-xs truncate\", children: s.path })\n              ] }),\n              s.status === \"complete\" && /* @__PURE__ */ e.jsxs(e.Fragment, { children: [\n                \"Successfully indexed \",\n                s.indexed,\n                \" pages.\"\n              ] }),\n              s.status === \"error\" && /* @__PURE__ */ e.jsx(\"span\", { className: \"text-destructive\", children: s.message })\n            ] })\n          ] }),\n          /* @__PURE__ */ e.jsx(D, { children: /* @__PURE__ */ e.jsxs(\"div\", { className: \"flex justify-end gap-2\", children: [\n            s.status === \"complete\" && /* @__PURE__ */ e.jsx(d, { size: \"sm\", onClick: o, children: \"Close and reload\" }),\n            s.status === \"error\" && /* @__PURE__ */ e.jsxs(e.Fragment, { children: [\n              /* @__PURE__ */ e.jsx(d, { variant: \"outline\", onClick: o, children: \"Cancel\" }),\n              /* @__PURE__ */ e.jsx(d, { onClick: r, children: \"Retry\" })\n            ] })\n          ] }) })\n        ]\n      }\n    )\n  ] });\n};\nexport {\n  F as default\n};\n//# sourceMappingURL=IndexingDialog-DZWj_3cU.js.map\n"],"names":["C","i","a","o","l","n","e","F","u","x","m","g","c","p","h","f","j","D","d"],"mappings":"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","x_google_ignoreList":[0]}