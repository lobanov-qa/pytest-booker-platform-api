{"version":3,"file":"entry.server.js","sources":["../../../../node_modules/zudoku/src/lib/components/cache.ts","../../../../node_modules/zudoku/src/lib/core/plugins.ts","../../../../node_modules/zudoku/src/lib/shiki.ts","../../../../node_modules/zudoku/src/app/ZuploBuildConfig.ts","../../../../node_modules/zudoku/src/app/env.ts","../../../../node_modules/zudoku/src/app/main.tsx","../../../../node_modules/zudoku/src/app/entry.server.tsx"],"sourcesContent":["import { useQueryClient } from \"@tanstack/react-query\";\nimport { useCallback } from \"react\";\n\nexport const CACHE_KEYS = Object.freeze({\n  API_IDENTITIES: [\"api-identities\"],\n});\n\ntype CacheKey = keyof typeof CACHE_KEYS;\n\nexport const useCache = () => {\n  const queryClient = useQueryClient();\n  const invalidateCache = useCallback(\n    (key: CacheKey) =>\n      queryClient.invalidateQueries({ queryKey: CACHE_KEYS[key] }),\n    [queryClient],\n  );\n\n  return { invalidateCache };\n};\n\n/**\n * If a query has this key in its queryKey, it will not put its result in the dehydrated state in the SSR.\n *\n * This is useful if the query should only be suspended and not included in the initial HTML response.\n * (e.g. too large in size, or not needed for the initial page load)\n */\nexport const NO_DEHYDRATE = \"no-dehydrate\";\n","import type { LucideIcon } from \"lucide-react\";\nimport type { ReactNode } from \"react\";\nimport type { Location, RouteObject } from \"react-router\";\nimport type { Navigation } from \"../../config/validators/NavigationSchema.js\";\nimport type { ProtectedRoutesInput } from \"../../config/validators/ProtectedRoutesSchema.js\";\nimport type { AuthenticationPlugin } from \"../authentication/authentication.js\";\nimport type { MdxComponentsType } from \"../util/MdxComponents.js\";\nimport type {\n  ApiIdentity,\n  ZudokuContext,\n  ZudokuEvents,\n} from \"./ZudokuContext.js\";\n\nexport type ZudokuPlugin =\n  | CommonPlugin\n  | ProfileMenuPlugin\n  | NavigationPlugin\n  | ApiIdentityPlugin\n  | SearchProviderPlugin\n  | EventConsumerPlugin\n  | AuthenticationPlugin;\n\nexport type { AuthenticationPlugin, RouteObject };\n\nexport interface NavigationPlugin {\n  getRoutes: () => RouteObject[];\n  getNavigation?: (path: string, context: ZudokuContext) => Promise<Navigation>;\n  getProtectedRoutes?: () => ProtectedRoutesInput;\n}\n\nexport const createApiIdentityPlugin = (\n  plugin: ApiIdentityPlugin,\n): ApiIdentityPlugin => plugin;\n\nexport const createProfileMenuPlugin = (\n  plugin: ProfileMenuPlugin,\n): ProfileMenuPlugin => plugin;\n\nexport interface ApiIdentityPlugin {\n  getIdentities: (context: ZudokuContext) => Promise<ApiIdentity[]>;\n}\n\nexport interface SearchProviderPlugin {\n  renderSearch: (o: {\n    isOpen: boolean;\n    onClose: () => void;\n  }) => React.JSX.Element | null;\n}\n\nexport interface ProfileMenuPlugin {\n  getProfileMenuItems: (context: ZudokuContext) => ProfileNavigationItem[];\n}\n\nexport type ProfileNavigationItem = {\n  label: string;\n  path?: string;\n  weight?: number;\n  category?: \"top\" | \"middle\" | \"bottom\";\n  children?: ProfileNavigationItem[];\n  icon?: LucideIcon;\n};\n\nexport interface CommonPlugin {\n  initialize?: (\n    context: ZudokuContext,\n  ) => Promise<void | boolean> | void | boolean;\n  getHead?: (args: { location: Location }) => ReactNode | undefined;\n  getMdxComponents?: () => MdxComponentsType;\n}\n\nexport type EventConsumerPlugin<Event extends ZudokuEvents = ZudokuEvents> = {\n  events: { [K in keyof Event]?: Event[K] };\n};\n\nexport const isEventConsumerPlugin = (\n  obj: ZudokuPlugin,\n): obj is EventConsumerPlugin =>\n  \"events\" in obj && typeof obj.events === \"object\";\n\nexport const isProfileMenuPlugin = (\n  obj: ZudokuPlugin,\n): obj is ProfileMenuPlugin =>\n  \"getProfileMenuItems\" in obj && typeof obj.getProfileMenuItems === \"function\";\n\nexport const isNavigationPlugin = (\n  obj: ZudokuPlugin,\n): obj is NavigationPlugin =>\n  \"getRoutes\" in obj && typeof obj.getRoutes === \"function\";\n\nexport const isAuthenticationPlugin = (\n  obj: ZudokuPlugin,\n): obj is AuthenticationPlugin =>\n  \"signUp\" in obj && typeof obj.signUp === \"function\";\n\nexport const isSearchPlugin = (\n  obj: ZudokuPlugin,\n): obj is SearchProviderPlugin =>\n  \"renderSearch\" in obj && typeof obj.renderSearch === \"function\";\n\nexport const needsInitialization = (obj: ZudokuPlugin): obj is CommonPlugin =>\n  \"initialize\" in obj && typeof obj.initialize === \"function\";\n\nexport const hasHead = (obj: ZudokuPlugin): obj is CommonPlugin =>\n  \"getHead\" in obj && typeof obj.getHead === \"function\";\n\nexport const isMdxProviderPlugin = (obj: ZudokuPlugin): obj is CommonPlugin =>\n  \"getMdxComponents\" in obj && typeof obj.getMdxComponents === \"function\";\n\nexport const isApiIdentityPlugin = (\n  obj: ZudokuPlugin,\n): obj is ApiIdentityPlugin =>\n  \"getIdentities\" in obj && typeof obj.getIdentities === \"function\";\n","import rehypeShikiFromHighlighter, {\n  type RehypeShikiCoreOptions,\n} from \"@shikijs/rehype/core\";\nimport {\n  transformerMetaHighlight,\n  transformerMetaWordHighlight,\n} from \"@shikijs/transformers\";\nimport type { Root } from \"hast\";\nimport { toJsxRuntime } from \"hast-util-to-jsx-runtime\";\nimport { createElement, Fragment } from \"react\";\nimport { jsx, jsxs } from \"react/jsx-runtime\";\nimport type {\n  BundledLanguage,\n  BundledTheme,\n  CodeOptionsMultipleThemes,\n  HighlighterCore,\n} from \"shiki\";\nimport { createHighlighterCore } from \"shiki/core\";\nimport { createJavaScriptRegexEngine } from \"shiki/engine/javascript\";\nimport type { Pluggable } from \"unified\";\nimport { visit } from \"unist-util-visit\";\nimport { cn } from \"./util/cn.js\";\n\nexport const HIGHLIGHT_CODE_BLOCK_CLASS =\n  \"overflow-x-auto scrollbar not-inline\";\n\nconst engine = createJavaScriptRegexEngine({ forgiving: true });\n\nconst shikiPromise = import.meta.hot?.data.shiki\n  ? import.meta.hot.data.shiki\n  : createHighlighterCore({\n      engine,\n      langAlias: {\n        markup: \"html\",\n        svg: \"xml\",\n        mathml: \"xml\",\n        atom: \"xml\",\n        ssml: \"xml\",\n        rss: \"xml\",\n        webmanifest: \"json\",\n      },\n    });\n\nif (import.meta.hot) {\n  import.meta.hot.data.shiki = shikiPromise;\n}\n\nexport const highlighter = await shikiPromise;\n\ntype ThemesRecord = CodeOptionsMultipleThemes<BundledTheme>[\"themes\"];\n\nexport const defaultHighlightOptions = {\n  themes: {\n    light: \"github-light\",\n    dark: \"github-dark\",\n  },\n  defaultColor: false,\n  defaultLanguage: \"text\",\n  fallbackLanguage: \"text\",\n  inline: \"tailing-curly-colon\",\n  addLanguageClass: true,\n  transformers: [transformerMetaHighlight(), transformerMetaWordHighlight()],\n  parseMetaString: (str) => {\n    // Matches key=\"value\", key=value, or key attributes\n    const matches = str.matchAll(\n      /([a-z0-9]+)(?:=([\"'])(.*?)\\2|=(.*?)(?:\\s|$)|(?:\\s|$))/gi,\n    );\n    return Object.fromEntries(\n      Array.from(matches).map((match) => {\n        const key = match[1];\n        const value = match[3] || match[4] || true;\n        return [key, value];\n      }),\n    );\n  },\n} satisfies RehypeShikiCoreOptions;\n\nexport const defaultLanguages: BundledLanguage[] = [\n  \"shellscript\",\n  \"javascript\",\n  \"jsx\",\n  \"typescript\",\n  \"tsx\",\n  \"graphql\",\n  \"jsonc\",\n  \"json\",\n  \"python\",\n  \"java\",\n  \"go\",\n  \"csharp\",\n  \"kotlin\",\n  \"objective-c\",\n  \"php\",\n  \"ruby\",\n  \"swift\",\n  \"css\",\n  \"html\",\n  \"xml\",\n  \"yaml\",\n  \"toml\",\n  \"rust\",\n  \"markdown\",\n  \"mdx\",\n  \"zig\",\n  \"scala\",\n  \"dart\",\n  \"ocaml\",\n  \"c\",\n  \"cpp\",\n  \"common-lisp\",\n  \"elixir\",\n  \"powershell\",\n];\n\nconst rehypeCodeBlockPlugin = () => (tree: Root) => {\n  visit(tree, \"element\", (node, _index, parent) => {\n    if (node.tagName !== \"code\") return;\n\n    const isCodeBlock = parent?.type === \"element\" && parent.tagName === \"pre\";\n    node.properties.inline = JSON.stringify(!isCodeBlock);\n\n    // Pass through properties from <pre> to <code> so we can handle it in `code` only\n    if (isCodeBlock) {\n      node.properties = {\n        ...node.properties,\n        ...structuredClone(parent.properties),\n        class: cn(node.properties.class, parent.properties.class),\n      };\n      parent.properties = {};\n    }\n  });\n};\n\nexport const createConfiguredShikiRehypePlugins = (\n  themes: ThemesRecord = defaultHighlightOptions.themes,\n  highlighterInstance: HighlighterCore = highlighter,\n) => [\n  [\n    rehypeShikiFromHighlighter,\n    highlighterInstance,\n    { ...defaultHighlightOptions, themes },\n  ] satisfies Pluggable,\n  rehypeCodeBlockPlugin,\n];\n\nexport const highlight = (\n  highlighter: HighlighterCore,\n  code: string,\n  lang = \"text\",\n  themes: ThemesRecord = defaultHighlightOptions.themes,\n) => {\n  const value = highlighter.codeToHast(code, {\n    lang,\n    ...defaultHighlightOptions,\n    themes,\n  });\n\n  return toJsxRuntime(value, {\n    Fragment,\n    jsx,\n    jsxs,\n    components: {\n      code: (props) =>\n        createElement(\"code\", {\n          ...props,\n          className: cn(props.className, HIGHLIGHT_CODE_BLOCK_CLASS),\n        }),\n    },\n  });\n};\n","import { z } from \"zod\";\n\nexport const EntitlementsSchema = z.object({\n  devPortalZuploBranding: z.boolean(),\n  numberOfProjects: z.number(),\n  numberOfUsers: z.number(),\n  egressGbPerMonth: z.number(),\n  requestsPerMonth: z.number(),\n  numberOfApiKeys: z.number(),\n  customDomains: z.number(),\n  advancedAnalyticsEnabled: z.boolean(),\n  devPortalAnalyticsEnabled: z.boolean(),\n  premiumSupport: z.boolean(),\n  emergencyPhoneSupport: z.boolean(),\n  rbacEnabled: z.boolean(),\n  onPremEnabled: z.boolean(),\n  largeBuildRunners: z.boolean(),\n});\n\nexport const BuildConfigSchema = z.object({\n  entitlements: EntitlementsSchema,\n  environmentType: z.string().optional(),\n  deploymentName: z.string(),\n  deploymentUrl: z.string().optional(),\n  projectId: z.string().optional(),\n  projectType: z.string().optional(),\n  sourceType: z.string().optional(),\n  accountName: z.string().optional(),\n  projectName: z.string().optional(),\n});\n\nexport type BuildConfig = z.infer<typeof BuildConfigSchema>;\nexport type Entitlements = z.infer<typeof EntitlementsSchema>;\n","import { z } from \"zod\";\nimport { BuildConfigSchema } from \"./ZuploBuildConfig.js\";\n\nconst getZuploBuildConfig = () => {\n  if (!process.env.ZUPLO_BUILD_CONFIG) return undefined;\n\n  try {\n    const zuploBuildConfig = BuildConfigSchema.parse(\n      JSON.parse(process.env.ZUPLO_BUILD_CONFIG),\n    );\n    return zuploBuildConfig;\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      // biome-ignore lint/suspicious/noConsole: Logging allowed here\n      console.error(\"ZUPLO_BUILD_CONFIG is invalid.\");\n      // biome-ignore lint/suspicious/noConsole: Logging allowed here\n      console.log(error.issues);\n      return undefined;\n    }\n    // biome-ignore lint/suspicious/noConsole: Logging allowed here\n    console.error(\n      \"ZUPLO_BUILD_CONFIG is a reserved environment variable and cannot be used for custom configuration. Please remove it from your environment variables.\",\n    );\n    // biome-ignore lint/suspicious/noConsole: Logging allowed here\n    console.log(error);\n    return undefined;\n  }\n};\n\nexport const ZuploEnv = {\n  /**\n   * Indicates that the build is running in Zuplo \"mode\"\n   */\n  get isZuplo(): boolean {\n    return process.env.ZUPLO === \"1\";\n  },\n\n  get serverUrl(): string | undefined {\n    return process.env.ZUPLO_SERVER_URL;\n  },\n\n  buildConfig: getZuploBuildConfig(),\n};\n","import { configuredApiKeysPlugin } from \"virtual:zudoku-api-keys-plugin\";\nimport {\n  configuredApiCatalogPlugins,\n  configuredApiPlugins,\n} from \"virtual:zudoku-api-plugins\";\nimport { configuredAuthProvider } from \"virtual:zudoku-auth\";\nimport { configuredCustomPagesPlugin } from \"virtual:zudoku-custom-pages-plugin\";\nimport { configuredDocsPlugin } from \"virtual:zudoku-docs-plugin\";\nimport { configuredNavigation } from \"virtual:zudoku-navigation\";\nimport { configuredRedirectPlugin } from \"virtual:zudoku-redirect-plugin\";\nimport { configuredSearchPlugin } from \"virtual:zudoku-search-plugin\";\nimport { registerShiki } from \"virtual:zudoku-shiki-register\";\nimport type { RouteObject } from \"react-router\";\nimport \"virtual:zudoku-theme.css\";\nimport {\n  BuildCheck,\n  Layout,\n  Meta,\n  RouteGuard,\n  RouterError,\n  StatusPage,\n} from \"zudoku/__internal\";\nimport { Zudoku } from \"zudoku/components\";\nimport { Outlet } from \"zudoku/router\";\nimport type { ZudokuConfig } from \"../config/config.js\";\nimport { isNavigationPlugin } from \"../lib/core/plugins.js\";\nimport type { ZudokuContextOptions } from \"../lib/core/ZudokuContext.js\";\nimport { highlighter } from \"../lib/shiki.js\";\nimport { ZuploEnv } from \"./env.js\";\nimport \"./main.css\";\n\nawait registerShiki(highlighter);\n\nexport const convertZudokuConfigToOptions = (\n  config: ZudokuConfig,\n): ZudokuContextOptions => {\n  return {\n    basePath: config.basePath,\n    canonicalUrlOrigin: config.canonicalUrlOrigin,\n    protectedRoutes: config.protectedRoutes,\n    site: {\n      ...config.site,\n      showPoweredBy:\n        ZuploEnv.buildConfig?.entitlements.devPortalZuploBranding ??\n        config.site?.showPoweredBy,\n      logo: config.site?.logo,\n    },\n    slots: config.slots,\n    metadata: {\n      favicon: \"https://cdn.zudoku.dev/logos/favicon.svg\",\n      title: \"%s - Zudoku\",\n      ...config.metadata,\n    },\n    navigation: configuredNavigation,\n    mdx: config.mdx,\n    plugins: [\n      ...(configuredAuthProvider ? [configuredAuthProvider] : []),\n      ...(configuredDocsPlugin ? [configuredDocsPlugin] : []),\n      ...configuredApiPlugins,\n      ...(configuredSearchPlugin ? [configuredSearchPlugin] : []),\n      ...(configuredRedirectPlugin ? [configuredRedirectPlugin] : []),\n      ...(configuredApiKeysPlugin ? [configuredApiKeysPlugin] : []),\n      ...(configuredCustomPagesPlugin ? [configuredCustomPagesPlugin] : []),\n      ...configuredApiCatalogPlugins,\n      ...(config.plugins ?? []),\n    ],\n    syntaxHighlighting: {\n      highlighter,\n      themes: config.syntaxHighlighting?.themes,\n    },\n  };\n};\n\nexport const getRoutesByOptions = (\n  options: ZudokuContextOptions,\n  enableStatusPages = true,\n) => {\n  const allPlugins = [\n    ...(options.plugins ?? []),\n    ...(options.authentication ? [options.authentication] : []),\n  ];\n\n  const routes = allPlugins\n    .flatMap((plugin) => (isNavigationPlugin(plugin) ? plugin.getRoutes() : []))\n    .concat(\n      enableStatusPages\n        ? [400, 404, 500].map((statusCode) => ({\n            path: `/${statusCode}`,\n            element: <StatusPage statusCode={statusCode} />,\n          }))\n        : [],\n    )\n    .concat([{ path: \"*\", element: <StatusPage statusCode={404} /> }])\n    .map((route) => ({\n      ...route,\n      errorElement: <RouterError className=\"w-full m-0\" />,\n    }));\n\n  // @TODO Detect conflicts in routes and log warning\n\n  return routes;\n};\n\nexport const getRoutesByConfig = (config: ZudokuConfig): RouteObject[] => {\n  const options = convertZudokuConfigToOptions(config);\n  const routes = getRoutesByOptions(\n    options,\n    import.meta.env.IS_ZUPLO || config.enableStatusPages,\n  );\n\n  return [\n    {\n      element: (\n        <Zudoku {...options}>\n          <BuildCheck\n            buildId={import.meta.env.ZUPLO_BUILD_ID}\n            environmentType={import.meta.env.ZUPLO_ENVIRONMENT_TYPE}\n          />\n          <Outlet />\n        </Zudoku>\n      ),\n      hydrateFallbackElement: <div>Loading...</div>,\n      children: [\n        {\n          element: (\n            <Meta>\n              <RouteGuard />\n            </Meta>\n          ),\n          errorElement: <RouterError />,\n          children: routes.map((r) =>\n            r.handle?.layout === \"none\" ? r : wrapWithLayout(r),\n          ),\n        },\n      ],\n    },\n  ];\n};\n\nconst wrapWithLayout = (route: RouteObject) => {\n  return {\n    element: <Layout />,\n    children: [route],\n  };\n};\n","import { Transform } from \"node:stream\";\nimport { dehydrate, QueryClient } from \"@tanstack/react-query\";\nimport type { HelmetData } from \"@zudoku/react-helmet-async\";\nimport type express from \"express\";\nimport logger from \"loglevel\";\nimport { renderToPipeableStream, renderToStaticMarkup } from \"react-dom/server\";\nimport {\n  createStaticHandler,\n  createStaticRouter,\n  isRouteErrorResponse,\n  type RouteObject,\n} from \"react-router\";\nimport \"vite/modulepreload-polyfill\";\nimport { BootstrapStatic, ServerError } from \"zudoku/__internal\";\nimport { NO_DEHYDRATE } from \"../lib/components/cache.js\";\nimport type { PrerenderResponse } from \"../vite/prerender/PrerenderResponse.js\";\nimport { getRoutesByConfig } from \"./main.js\";\nexport { getRoutesByConfig };\n\nexport const render = async ({\n  template,\n  request: baseRequest,\n  response,\n  routes,\n  basePath,\n  bypassProtection,\n}: {\n  template: string;\n  request: express.Request | Request;\n  response: express.Response | PrerenderResponse;\n  routes: RouteObject[];\n  basePath?: string;\n  bypassProtection?: boolean;\n}) => {\n  const { query, dataRoutes } = createStaticHandler(routes, {\n    basename: basePath,\n  });\n  const queryClient = new QueryClient();\n\n  const request =\n    baseRequest instanceof Request\n      ? baseRequest\n      : createFetchRequest(baseRequest, response);\n\n  const context = await query(request);\n  let status = 200;\n\n  if (context instanceof Response) {\n    if ([301, 302, 303, 307, 308].includes(context.status)) {\n      return response.redirect(\n        import.meta.env.PROD ? context.status : 307,\n        context.headers.get(\"Location\") ?? \"\",\n      );\n    }\n\n    throw context;\n  } else if (context.errors) {\n    // when throwing a Response from a loader it will be caught here\n    // unfortunately it is not `instanceof Response` for some reason\n    const firstError = Object.values(context.errors).find(isRouteErrorResponse);\n\n    if (firstError?.status) {\n      status = firstError.status;\n    }\n  }\n\n  const router = createStaticRouter(dataRoutes, context);\n  const helmetContext = {} as HelmetData[\"context\"];\n\n  const App = (\n    <BootstrapStatic\n      router={router}\n      context={context}\n      queryClient={queryClient}\n      helmetContext={helmetContext}\n      bypassProtection={bypassProtection}\n    />\n  );\n\n  const { pipe } = renderToPipeableStream(App, {\n    onShellError(error) {\n      response.status(500);\n      response.set({ \"Content-Type\": \"text/html\" });\n\n      const html = renderToStaticMarkup(<ServerError error={error} />);\n\n      response.send(html);\n    },\n    onAllReady() {\n      response.set({ \"Content-Type\": \"text/html\" });\n      response.status(status);\n\n      const transformStream = new Transform({\n        transform(chunk, encoding, callback) {\n          response.write(chunk, encoding);\n          callback();\n        },\n      });\n\n      const [htmlStart, htmlEnd] = template.split(\"<!--app-html-->\");\n\n      if (!htmlStart) {\n        throw new Error(\"No <!--app-html--> found in template\");\n      }\n\n      response.write(\n        htmlStart.replace(\n          \"<!--app-helmet-->\",\n          [\n            helmetContext.helmet.title.toString(),\n            helmetContext.helmet.meta.toString(),\n            helmetContext.helmet.link.toString(),\n            helmetContext.helmet.style.toString(),\n            helmetContext.helmet.script.toString(),\n          ].join(\"\\n\"),\n        ),\n      );\n\n      transformStream.on(\"finish\", () => {\n        const dehydrated = dehydrate(queryClient, {\n          shouldDehydrateQuery: (query) =>\n            !query.queryKey.includes(NO_DEHYDRATE),\n        });\n\n        if (!htmlEnd) return response.end();\n\n        const closingTag = \"</body>\";\n        const idx = htmlEnd.lastIndexOf(closingTag);\n\n        if (idx === -1) return response.end(htmlEnd);\n\n        const serialized = JSON.stringify(dehydrated)\n          .replace(/</g, \"\\\\u003c\")\n          .replace(/>/g, \"\\\\u003e\");\n\n        response.write(htmlEnd.slice(0, idx));\n        response.write(\"<script>window.DATA=\");\n        response.write(serialized);\n        response.write(\"</script>\");\n        response.end(htmlEnd.slice(idx));\n      });\n\n      pipe(transformStream);\n    },\n    onError(error) {\n      status = 500;\n      if (import.meta.env.PROD) {\n        throw error;\n      }\n      logger.error(error);\n    },\n  });\n};\n\nexport function createFetchRequest(\n  req: express.Request,\n  res: express.Response | PrerenderResponse,\n): Request {\n  const origin = `${req.protocol}://${req.get(\"host\")}`;\n  // Note: This had to take originalUrl into account for presumably vite's proxying\n  const url = new URL(req.originalUrl || req.url, origin);\n\n  const controller = new AbortController();\n  res.on(\"close\", () => controller.abort());\n\n  const headers = new Headers();\n\n  for (const [key, values] of Object.entries(req.headers)) {\n    if (values) {\n      if (Array.isArray(values)) {\n        for (const value of values) {\n          headers.append(key, value);\n        }\n      } else {\n        headers.set(key, values);\n      }\n    }\n  }\n\n  const init: RequestInit = {\n    method: req.method,\n    headers,\n    signal: controller.signal,\n  };\n\n  if (req.method !== \"GET\" && req.method !== \"HEAD\") {\n    init.body = req.body;\n  }\n\n  return new Request(url.href, init);\n}\n"],"names":["config","query"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6]}